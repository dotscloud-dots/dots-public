[2025-07-16T15:38:24Z DEBUG dotops] No config file found at default path '/etc/dots/dotctl-dotops.conf'. Using cli arguments and environment variables only.
[2025-07-16T15:38:24Z DEBUG dotops] Starting the Dots dotops with 
    	dotops address: '127.0.0.1:25551', 
    	startup manifest path: '/__w/dot/dot/tests/resources/configs/manifest_with_configs.yaml'
[2025-07-16T15:38:24Z DEBUG dotops::dots_server::config_renderer] Rendering workload 'greeting_person' with config '{"person": ConfigArray([ConfigObject({"name": String("John Doe"), "age": String("30")}), ConfigObject({"name": String("Chris Smith"), "age": String("40")})])}'
[2025-07-16T15:38:24Z DEBUG handlebars::render] Rendering helper: "each", params: [PathAndJson { relative_path: Some("person"), value: Context(Array [Object {"age": String("30"), "name": String("John Doe")}, Object {"age": String("40"), "name": String("Chris Smith")}], ["person"]) }], hash: {}
[2025-07-16T15:38:24Z DEBUG handlebars::render] Rendering helper: "if", params: [PathAndJson { relative_path: None, value: Derived(Bool(false)) }], hash: {}
[2025-07-16T15:38:24Z DEBUG handlebars::render] Rendering helper: "if", params: [PathAndJson { relative_path: None, value: Derived(Bool(true)) }], hash: {}
[2025-07-16T15:38:24Z DEBUG handlebars::render] Rendering value: Path(Relative(([Named("name")], "this.name")))
[2025-07-16T15:38:24Z DEBUG handlebars::render] Rendering value: Path(Relative(([Named("age")], "this.age")))
[2025-07-16T15:38:24Z DEBUG dotops::dots_server::config_renderer] Rendering workload 'nginx' with config '{"port": ConfigObject({"access_port": String("8081")}), "agent": ConfigObject({"agent_name": String("agent_A")})}'
[2025-07-16T15:38:24Z DEBUG handlebars::render] Rendering value: Path(Relative(([Named("port"), Named("access_port")], "port.access_port")))
[2025-07-16T15:38:24Z DEBUG handlebars::render] Rendering value: Path(Relative(([Named("agent"), Named("agent_name")], "agent.agent_name")))
[2025-07-16T15:38:24Z INFO  dotops::dots_server] Starting...
[2025-07-16T15:38:24Z DEBUG dotops::dots_server] Start listening to agents...
[2025-07-16T15:38:24Z WARN  grpc::server] !!!DOTOPS IS STARTED IN INSECURE MODE (-k, --insecure) -> TLS is disabled!!!
[2025-07-16T15:38:24Z INFO  grpc::from_server_proxy] Agent agent_A not found, workloads not sent. Waiting for dot to connect.
[2025-07-16T15:38:24Z INFO  dotops::dots_server] Received AgentHello from 'agent_A'
[2025-07-16T15:38:24Z DEBUG dotops::dots_server] No workload states to send.
[2025-07-16T15:38:24Z DEBUG dotops::dots_server] Sending initial ServerHello to dot 'agent_A' with added workloads: '[WorkloadSpec { instance_name: WorkloadInstanceName { agent_name: "agent_A", workload_name: "greeting_person", id: "2407ceea94e0bc8a0ada66c982bf667c494ed1e0b3b0e70e349475832870476f" }, tags: [], dependencies: {}, restart_policy: Never, runtime: "podman", runtime_config: "image: dotscloud/nginx:latest\ncommandArgs: [ \"echo\", 'Hello Chris Smith(age: 40)\\n' ]\n", files: [], control_interface_access: ControlInterfaceAccess { allow_rules: [], deny_rules: [] } }, WorkloadSpec { instance_name: WorkloadInstanceName { agent_name: "agent_A", workload_name: "nginx", id: "82b35ef2d215eb7c4e5d66874fb724f045af53c8ed59663f0189cc8d6df53fb5" }, tags: [], dependencies: {}, restart_policy: Never, runtime: "podman", runtime_config: "image: dotscloud/nginx:latest\ncommandOptions: [ \"-p\", \"8081:80\"]\n", files: [], control_interface_access: ControlInterfaceAccess { allow_rules: [], deny_rules: [] } }]'
[2025-07-16T15:38:24Z DEBUG grpc::grpc_cli_connection] Connection to CLI (name=cli-conn-d16d8fd3-42ed-4905-9684-bcd7d5d17b7e) open.
[2025-07-16T15:38:24Z DEBUG grpc::to_server_proxy] Received Request from 'cli-conn-d16d8fd3-42ed-4905-9684-bcd7d5d17b7e'
[2025-07-16T15:38:24Z DEBUG dotops::dots_server] Received CompleteStateRequest with id 'cli-conn-d16d8fd3-42ed-4905-9684-bcd7d5d17b7e@16eb74c5-d07e-45ad-9372-7a4b668b3214' and field mask: '[]'
[2025-07-16T15:38:24Z DEBUG grpc::grpc_cli_connection] Connection to CLI (name=cli-conn-d16d8fd3-42ed-4905-9684-bcd7d5d17b7e) failed with Err(ConnectionInterrupted("status: Unknown, message: \"h2 protocol error: error reading a body from connection: stream closed because of a broken pipe\", details: [], metadata: MetadataMap { headers: {} }")).
[2025-07-16T15:38:24Z DEBUG grpc::grpc_cli_connection] Connection to CLI (name=cli-conn-d16d8fd3-42ed-4905-9684-bcd7d5d17b7e) has been closed.
[2025-07-16T15:38:24Z DEBUG dotops::dots_server] Received UpdateWorkloadState: '[WorkloadState { instance_name: WorkloadInstanceName { agent_name: "agent_A", workload_name: "greeting_person", id: "2407ceea94e0bc8a0ada66c982bf667c494ed1e0b3b0e70e349475832870476f" }, execution_state: ExecutionState { state: Pending(Starting), additional_info: "Triggered at runtime." } }]'
[2025-07-16T15:38:24Z DEBUG dotops::dots_server] Received UpdateWorkloadState: '[WorkloadState { instance_name: WorkloadInstanceName { agent_name: "agent_A", workload_name: "nginx", id: "82b35ef2d215eb7c4e5d66874fb724f045af53c8ed59663f0189cc8d6df53fb5" }, execution_state: ExecutionState { state: Pending(Starting), additional_info: "Triggered at runtime." } }]'
[2025-07-16T15:38:24Z DEBUG dotops::dots_server] Received UpdateWorkloadState: '[WorkloadState { instance_name: WorkloadInstanceName { agent_name: "agent_A", workload_name: "nginx", id: "82b35ef2d215eb7c4e5d66874fb724f045af53c8ed59663f0189cc8d6df53fb5" }, execution_state: ExecutionState { state: Running(Ok), additional_info: "" } }]'
[2025-07-16T15:38:24Z DEBUG dotops::dots_server] Received UpdateWorkloadState: '[WorkloadState { instance_name: WorkloadInstanceName { agent_name: "agent_A", workload_name: "greeting_person", id: "2407ceea94e0bc8a0ada66c982bf667c494ed1e0b3b0e70e349475832870476f" }, execution_state: ExecutionState { state: Running(Ok), additional_info: "" } }]'
[2025-07-16T15:38:24Z DEBUG grpc::grpc_cli_connection] Connection to CLI (name=cli-conn-0f7448d3-348f-40a1-8b14-9a2d305fcc8e) open.
[2025-07-16T15:38:24Z DEBUG grpc::to_server_proxy] Received Request from 'cli-conn-0f7448d3-348f-40a1-8b14-9a2d305fcc8e'
[2025-07-16T15:38:24Z DEBUG dotops::dots_server] Received CompleteStateRequest with id 'cli-conn-0f7448d3-348f-40a1-8b14-9a2d305fcc8e@511782ab-235e-431e-8c0d-9d7256a502c7' and field mask: '[]'
[2025-07-16T15:38:24Z DEBUG grpc::grpc_cli_connection] Connection to CLI (name=cli-conn-0f7448d3-348f-40a1-8b14-9a2d305fcc8e) failed with Err(ConnectionInterrupted("status: Unknown, message: \"h2 protocol error: error reading a body from connection: stream closed because of a broken pipe\", details: [], metadata: MetadataMap { headers: {} }")).
[2025-07-16T15:38:24Z DEBUG grpc::grpc_cli_connection] Connection to CLI (name=cli-conn-0f7448d3-348f-40a1-8b14-9a2d305fcc8e) has been closed.
[2025-07-16T15:38:25Z DEBUG grpc::grpc_cli_connection] Connection to CLI (name=cli-conn-d88e9ba8-6136-49ab-81ae-e532e11c7990) open.
[2025-07-16T15:38:25Z DEBUG grpc::to_server_proxy] Received Request from 'cli-conn-d88e9ba8-6136-49ab-81ae-e532e11c7990'
[2025-07-16T15:38:25Z DEBUG dotops::dots_server] Received CompleteStateRequest with id 'cli-conn-d88e9ba8-6136-49ab-81ae-e532e11c7990@355836bf-e8ea-4632-aa92-0e616c8e8c68' and field mask: '[]'
[2025-07-16T15:38:25Z DEBUG grpc::to_server_proxy] Received Request from 'cli-conn-d88e9ba8-6136-49ab-81ae-e532e11c7990'
[2025-07-16T15:38:25Z DEBUG grpc::to_server_proxy] Received UpdateStateRequest from 'cli-conn-d88e9ba8-6136-49ab-81ae-e532e11c7990'
[2025-07-16T15:38:25Z DEBUG dotops::dots_server] Received UpdateState. State 'CompleteState { desired_state: State { api_version: "v0.1", workloads: {}, configs: {"web_server_config": ConfigObject({"access_port": String("8082")}), "agents": ConfigObject({"agent_name": String("agent_A")}), "person": ConfigArray([ConfigObject({"name": String("John Doe"), "age": String("30")}), ConfigObject({"age": String("40"), "name": String("Chris Smith")})])} }, workload_states: WorkloadStatesMap({}), agents: AgentMap({}) }', update mask '["desiredState.configs"]'
[2025-07-16T15:38:25Z DEBUG dotops::dots_server::config_renderer] Rendering workload 'greeting_person' with config '{"person": ConfigArray([ConfigObject({"name": String("John Doe"), "age": String("30")}), ConfigObject({"age": String("40"), "name": String("Chris Smith")})])}'
[2025-07-16T15:38:25Z DEBUG handlebars::render] Rendering helper: "each", params: [PathAndJson { relative_path: Some("person"), value: Context(Array [Object {"age": String("30"), "name": String("John Doe")}, Object {"age": String("40"), "name": String("Chris Smith")}], ["person"]) }], hash: {}
[2025-07-16T15:38:25Z DEBUG handlebars::render] Rendering helper: "if", params: [PathAndJson { relative_path: None, value: Derived(Bool(false)) }], hash: {}
[2025-07-16T15:38:25Z DEBUG handlebars::render] Rendering helper: "if", params: [PathAndJson { relative_path: None, value: Derived(Bool(true)) }], hash: {}
[2025-07-16T15:38:25Z DEBUG handlebars::render] Rendering value: Path(Relative(([Named("name")], "this.name")))
[2025-07-16T15:38:25Z DEBUG handlebars::render] Rendering value: Path(Relative(([Named("age")], "this.age")))
[2025-07-16T15:38:25Z DEBUG dotops::dots_server::config_renderer] Rendering workload 'nginx' with config '{"agent": ConfigObject({"agent_name": String("agent_A")}), "port": ConfigObject({"access_port": String("8082")})}'
[2025-07-16T15:38:25Z DEBUG handlebars::render] Rendering value: Path(Relative(([Named("port"), Named("access_port")], "port.access_port")))
[2025-07-16T15:38:25Z DEBUG handlebars::render] Rendering value: Path(Relative(([Named("agent"), Named("agent_name")], "agent.agent_name")))
[2025-07-16T15:38:25Z INFO  dotops::dots_server] The update has 1 new or updated workloads, 1 workloads to delete
[2025-07-16T15:38:25Z DEBUG dotops::dots_server] Send UpdateStateSuccess for request 'cli-conn-d88e9ba8-6136-49ab-81ae-e532e11c7990@d3f215d4-2f6c-4242-8b73-a4660e13f434'
[2025-07-16T15:38:25Z DEBUG grpc::to_server_proxy] Received Request from 'cli-conn-d88e9ba8-6136-49ab-81ae-e532e11c7990'
[2025-07-16T15:38:25Z DEBUG dotops::dots_server] Received CompleteStateRequest with id 'cli-conn-d88e9ba8-6136-49ab-81ae-e532e11c7990@085b599d-7261-4e7d-be14-c29508a7efeb' and field mask: '[]'
[2025-07-16T15:38:25Z DEBUG dotops::dots_server] Received UpdateWorkloadState: '[WorkloadState { instance_name: WorkloadInstanceName { agent_name: "agent_A", workload_name: "nginx", id: "82b35ef2d215eb7c4e5d66874fb724f045af53c8ed59663f0189cc8d6df53fb5" }, execution_state: ExecutionState { state: Stopping(RequestedAtRuntime), additional_info: "" } }]'
[2025-07-16T15:38:25Z DEBUG dotops::dots_server] Received UpdateWorkloadState: '[WorkloadState { instance_name: WorkloadInstanceName { agent_name: "agent_A", workload_name: "nginx", id: "82b35ef2d215eb7c4e5d66874fb724f045af53c8ed59663f0189cc8d6df53fb5" }, execution_state: ExecutionState { state: Removed, additional_info: "" } }]'
[2025-07-16T15:38:25Z DEBUG dotops::dots_server] Received UpdateWorkloadState: '[WorkloadState { instance_name: WorkloadInstanceName { agent_name: "agent_A", workload_name: "nginx", id: "85b04464a8c3b5348f5976cba412a535beb13155eceb62005531030932cde947" }, execution_state: ExecutionState { state: Pending(Starting), additional_info: "Triggered at runtime." } }]'
[2025-07-16T15:38:25Z DEBUG dotops::dots_server] Received UpdateWorkloadState: '[WorkloadState { instance_name: WorkloadInstanceName { agent_name: "agent_A", workload_name: "nginx", id: "85b04464a8c3b5348f5976cba412a535beb13155eceb62005531030932cde947" }, execution_state: ExecutionState { state: Running(Ok), additional_info: "" } }]'
[2025-07-16T15:38:25Z DEBUG grpc::grpc_cli_connection] Connection to CLI (name=cli-conn-d88e9ba8-6136-49ab-81ae-e532e11c7990) has been closed.
[2025-07-16T15:38:25Z DEBUG dotops::dots_server] Received UpdateWorkloadState: '[WorkloadState { instance_name: WorkloadInstanceName { agent_name: "agent_A", workload_name: "greeting_person", id: "2407ceea94e0bc8a0ada66c982bf667c494ed1e0b3b0e70e349475832870476f" }, execution_state: ExecutionState { state: Succeeded(Ok), additional_info: "" } }]'
[2025-07-16T15:38:25Z DEBUG grpc::grpc_cli_connection] Connection to CLI (name=cli-conn-2aa49e96-66af-4bec-b4c2-dcd5a2daae10) open.
[2025-07-16T15:38:25Z DEBUG grpc::to_server_proxy] Received Request from 'cli-conn-2aa49e96-66af-4bec-b4c2-dcd5a2daae10'
[2025-07-16T15:38:25Z DEBUG dotops::dots_server] Received CompleteStateRequest with id 'cli-conn-2aa49e96-66af-4bec-b4c2-dcd5a2daae10@a935f557-6734-4583-a459-b37be5d533b0' and field mask: '[]'
[2025-07-16T15:38:25Z DEBUG grpc::grpc_cli_connection] Connection to CLI (name=cli-conn-2aa49e96-66af-4bec-b4c2-dcd5a2daae10) failed with Err(ConnectionInterrupted("status: Unknown, message: \"h2 protocol error: error reading a body from connection: stream closed because of a broken pipe\", details: [], metadata: MetadataMap { headers: {} }")).
[2025-07-16T15:38:25Z DEBUG grpc::grpc_cli_connection] Connection to CLI (name=cli-conn-2aa49e96-66af-4bec-b4c2-dcd5a2daae10) has been closed.
