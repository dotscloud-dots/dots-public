[2025-07-16T15:54:21Z DEBUG dotops] No config file found at default path '/etc/dots/dotctl-dotops.conf'. Using cli arguments and environment variables only.
[2025-07-16T15:54:21Z DEBUG dotops] Starting the Dots dotops with 
    	dotops address: '127.0.0.1:25551', 
    	startup manifest path: '/__w/dot/dot/tests/resources/configs/manifest_with_configs.yaml'
[2025-07-16T15:54:21Z DEBUG dotops::dots_server::config_renderer] Rendering workload 'nginx' with config '{"agent": ConfigObject({"agent_name": String("agent_A")}), "port": ConfigObject({"access_port": String("8081")})}'
[2025-07-16T15:54:21Z DEBUG handlebars::render] Rendering value: Path(Relative(([Named("port"), Named("access_port")], "port.access_port")))
[2025-07-16T15:54:21Z DEBUG handlebars::render] Rendering value: Path(Relative(([Named("agent"), Named("agent_name")], "agent.agent_name")))
[2025-07-16T15:54:21Z DEBUG dotops::dots_server::config_renderer] Rendering workload 'greeting_person' with config '{"person": ConfigArray([ConfigObject({"name": String("John Doe"), "age": String("30")}), ConfigObject({"name": String("Chris Smith"), "age": String("40")})])}'
[2025-07-16T15:54:21Z DEBUG handlebars::render] Rendering helper: "each", params: [PathAndJson { relative_path: Some("person"), value: Context(Array [Object {"age": String("30"), "name": String("John Doe")}, Object {"age": String("40"), "name": String("Chris Smith")}], ["person"]) }], hash: {}
[2025-07-16T15:54:21Z DEBUG handlebars::render] Rendering helper: "if", params: [PathAndJson { relative_path: None, value: Derived(Bool(false)) }], hash: {}
[2025-07-16T15:54:21Z DEBUG handlebars::render] Rendering helper: "if", params: [PathAndJson { relative_path: None, value: Derived(Bool(true)) }], hash: {}
[2025-07-16T15:54:21Z DEBUG handlebars::render] Rendering value: Path(Relative(([Named("name")], "this.name")))
[2025-07-16T15:54:21Z DEBUG handlebars::render] Rendering value: Path(Relative(([Named("age")], "this.age")))
[2025-07-16T15:54:21Z INFO  dotops::dots_server] Starting...
[2025-07-16T15:54:21Z DEBUG dotops::dots_server] Start listening to agents...
[2025-07-16T15:54:21Z WARN  grpc::server] !!!DOTOPS IS STARTED IN INSECURE MODE (-k, --insecure) -> TLS is disabled!!!
[2025-07-16T15:54:21Z INFO  grpc::from_server_proxy] Agent agent_A not found, workloads not sent. Waiting for dot to connect.
[2025-07-16T15:54:21Z INFO  dotops::dots_server] Received AgentHello from 'agent_A'
[2025-07-16T15:54:21Z DEBUG dotops::dots_server] No workload states to send.
[2025-07-16T15:54:21Z DEBUG dotops::dots_server] Sending initial ServerHello to dot 'agent_A' with added workloads: '[WorkloadSpec { instance_name: WorkloadInstanceName { agent_name: "agent_A", workload_name: "greeting_person", id: "2407ceea94e0bc8a0ada66c982bf667c494ed1e0b3b0e70e349475832870476f" }, tags: [], dependencies: {}, restart_policy: Never, runtime: "podman", runtime_config: "image: dotscloud/nginx:latest\ncommandArgs: [ \"echo\", 'Hello Chris Smith(age: 40)\\n' ]\n", files: [], control_interface_access: ControlInterfaceAccess { allow_rules: [], deny_rules: [] } }, WorkloadSpec { instance_name: WorkloadInstanceName { agent_name: "agent_A", workload_name: "nginx", id: "82b35ef2d215eb7c4e5d66874fb724f045af53c8ed59663f0189cc8d6df53fb5" }, tags: [], dependencies: {}, restart_policy: Never, runtime: "podman", runtime_config: "image: dotscloud/nginx:latest\ncommandOptions: [ \"-p\", \"8081:80\"]\n", files: [], control_interface_access: ControlInterfaceAccess { allow_rules: [], deny_rules: [] } }]'
[2025-07-16T15:54:21Z DEBUG grpc::grpc_cli_connection] Connection to CLI (name=cli-conn-6dedf63c-eb8b-4d9e-b46d-358ac0372ae8) open.
[2025-07-16T15:54:21Z DEBUG grpc::to_server_proxy] Received Request from 'cli-conn-6dedf63c-eb8b-4d9e-b46d-358ac0372ae8'
[2025-07-16T15:54:21Z DEBUG dotops::dots_server] Received CompleteStateRequest with id 'cli-conn-6dedf63c-eb8b-4d9e-b46d-358ac0372ae8@86233627-d1d0-4269-a235-233d0edb81e0' and field mask: '[]'
[2025-07-16T15:54:21Z DEBUG grpc::grpc_cli_connection] Connection to CLI (name=cli-conn-6dedf63c-eb8b-4d9e-b46d-358ac0372ae8) failed with Err(ConnectionInterrupted("status: Unknown, message: \"h2 protocol error: error reading a body from connection: stream closed because of a broken pipe\", details: [], metadata: MetadataMap { headers: {} }")).
[2025-07-16T15:54:21Z DEBUG grpc::grpc_cli_connection] Connection to CLI (name=cli-conn-6dedf63c-eb8b-4d9e-b46d-358ac0372ae8) has been closed.
[2025-07-16T15:54:21Z DEBUG dotops::dots_server] Received UpdateWorkloadState: '[WorkloadState { instance_name: WorkloadInstanceName { agent_name: "agent_A", workload_name: "greeting_person", id: "2407ceea94e0bc8a0ada66c982bf667c494ed1e0b3b0e70e349475832870476f" }, execution_state: ExecutionState { state: Pending(Starting), additional_info: "Triggered at runtime." } }]'
[2025-07-16T15:54:21Z DEBUG dotops::dots_server] Received UpdateWorkloadState: '[WorkloadState { instance_name: WorkloadInstanceName { agent_name: "agent_A", workload_name: "nginx", id: "82b35ef2d215eb7c4e5d66874fb724f045af53c8ed59663f0189cc8d6df53fb5" }, execution_state: ExecutionState { state: Pending(Starting), additional_info: "Triggered at runtime." } }]'
[2025-07-16T15:54:21Z DEBUG dotops::dots_server] Received UpdateWorkloadState: '[WorkloadState { instance_name: WorkloadInstanceName { agent_name: "agent_A", workload_name: "greeting_person", id: "2407ceea94e0bc8a0ada66c982bf667c494ed1e0b3b0e70e349475832870476f" }, execution_state: ExecutionState { state: Running(Ok), additional_info: "" } }]'
[2025-07-16T15:54:21Z DEBUG grpc::grpc_cli_connection] Connection to CLI (name=cli-conn-376f5a40-c6dc-4153-bffd-8129d4bb02ef) open.
[2025-07-16T15:54:21Z DEBUG grpc::to_server_proxy] Received Request from 'cli-conn-376f5a40-c6dc-4153-bffd-8129d4bb02ef'
[2025-07-16T15:54:21Z DEBUG dotops::dots_server] Received CompleteStateRequest with id 'cli-conn-376f5a40-c6dc-4153-bffd-8129d4bb02ef@259c4a81-db8b-43b8-a722-d5f9cdce755c' and field mask: '[]'
[2025-07-16T15:54:21Z DEBUG grpc::grpc_cli_connection] Connection to CLI (name=cli-conn-376f5a40-c6dc-4153-bffd-8129d4bb02ef) failed with Err(ConnectionInterrupted("status: Unknown, message: \"h2 protocol error: error reading a body from connection: stream closed because of a broken pipe\", details: [], metadata: MetadataMap { headers: {} }")).
[2025-07-16T15:54:21Z DEBUG grpc::grpc_cli_connection] Connection to CLI (name=cli-conn-376f5a40-c6dc-4153-bffd-8129d4bb02ef) has been closed.
[2025-07-16T15:54:21Z DEBUG dotops::dots_server] Received UpdateWorkloadState: '[WorkloadState { instance_name: WorkloadInstanceName { agent_name: "agent_A", workload_name: "nginx", id: "82b35ef2d215eb7c4e5d66874fb724f045af53c8ed59663f0189cc8d6df53fb5" }, execution_state: ExecutionState { state: Running(Ok), additional_info: "" } }]'
[2025-07-16T15:54:21Z DEBUG grpc::grpc_cli_connection] Connection to CLI (name=cli-conn-6b817b0b-16b0-48c0-935c-b52466f0675e) open.
[2025-07-16T15:54:21Z DEBUG grpc::to_server_proxy] Received Request from 'cli-conn-6b817b0b-16b0-48c0-935c-b52466f0675e'
[2025-07-16T15:54:21Z DEBUG dotops::dots_server] Received CompleteStateRequest with id 'cli-conn-6b817b0b-16b0-48c0-935c-b52466f0675e@020f7467-301a-4bbe-8bbf-06c9f675c462' and field mask: '[]'
[2025-07-16T15:54:21Z DEBUG grpc::to_server_proxy] Received Request from 'cli-conn-6b817b0b-16b0-48c0-935c-b52466f0675e'
[2025-07-16T15:54:21Z DEBUG grpc::to_server_proxy] Received UpdateStateRequest from 'cli-conn-6b817b0b-16b0-48c0-935c-b52466f0675e'
[2025-07-16T15:54:21Z DEBUG dotops::dots_server] Received UpdateState. State 'CompleteState { desired_state: State { api_version: "v0.1", workloads: {}, configs: {"person": ConfigArray([ConfigObject({"name": String("John Doe"), "age": String("30")}), ConfigObject({"age": String("40"), "name": String("Chris Smith")})]), "agents": ConfigObject({"agent_name": String("agent_A")}), "web_server_config": ConfigObject({"access_port": String("8082")})} }, workload_states: WorkloadStatesMap({}), agents: AgentMap({}) }', update mask '["desiredState.configs"]'
[2025-07-16T15:54:21Z DEBUG dotops::dots_server::config_renderer] Rendering workload 'nginx' with config '{"port": ConfigObject({"access_port": String("8082")}), "agent": ConfigObject({"agent_name": String("agent_A")})}'
[2025-07-16T15:54:21Z DEBUG handlebars::render] Rendering value: Path(Relative(([Named("port"), Named("access_port")], "port.access_port")))
[2025-07-16T15:54:21Z DEBUG handlebars::render] Rendering value: Path(Relative(([Named("agent"), Named("agent_name")], "agent.agent_name")))
[2025-07-16T15:54:21Z DEBUG dotops::dots_server::config_renderer] Rendering workload 'greeting_person' with config '{"person": ConfigArray([ConfigObject({"age": String("30"), "name": String("John Doe")}), ConfigObject({"name": String("Chris Smith"), "age": String("40")})])}'
[2025-07-16T15:54:21Z DEBUG handlebars::render] Rendering helper: "each", params: [PathAndJson { relative_path: Some("person"), value: Context(Array [Object {"age": String("30"), "name": String("John Doe")}, Object {"age": String("40"), "name": String("Chris Smith")}], ["person"]) }], hash: {}
[2025-07-16T15:54:21Z DEBUG handlebars::render] Rendering helper: "if", params: [PathAndJson { relative_path: None, value: Derived(Bool(false)) }], hash: {}
[2025-07-16T15:54:21Z DEBUG handlebars::render] Rendering helper: "if", params: [PathAndJson { relative_path: None, value: Derived(Bool(true)) }], hash: {}
[2025-07-16T15:54:21Z DEBUG handlebars::render] Rendering value: Path(Relative(([Named("name")], "this.name")))
[2025-07-16T15:54:21Z DEBUG handlebars::render] Rendering value: Path(Relative(([Named("age")], "this.age")))
[2025-07-16T15:54:21Z INFO  dotops::dots_server] The update has 1 new or updated workloads, 1 workloads to delete
[2025-07-16T15:54:21Z DEBUG dotops::dots_server] Send UpdateStateSuccess for request 'cli-conn-6b817b0b-16b0-48c0-935c-b52466f0675e@0a537da7-2be8-47a7-8e22-e17ce5e15a40'
[2025-07-16T15:54:21Z DEBUG grpc::to_server_proxy] Received Request from 'cli-conn-6b817b0b-16b0-48c0-935c-b52466f0675e'
[2025-07-16T15:54:21Z DEBUG dotops::dots_server] Received CompleteStateRequest with id 'cli-conn-6b817b0b-16b0-48c0-935c-b52466f0675e@41cb0286-d775-4c20-a168-8645733527c9' and field mask: '[]'
[2025-07-16T15:54:21Z DEBUG dotops::dots_server] Received UpdateWorkloadState: '[WorkloadState { instance_name: WorkloadInstanceName { agent_name: "agent_A", workload_name: "nginx", id: "82b35ef2d215eb7c4e5d66874fb724f045af53c8ed59663f0189cc8d6df53fb5" }, execution_state: ExecutionState { state: Stopping(RequestedAtRuntime), additional_info: "" } }]'
[2025-07-16T15:54:22Z DEBUG dotops::dots_server] Received UpdateWorkloadState: '[WorkloadState { instance_name: WorkloadInstanceName { agent_name: "agent_A", workload_name: "nginx", id: "82b35ef2d215eb7c4e5d66874fb724f045af53c8ed59663f0189cc8d6df53fb5" }, execution_state: ExecutionState { state: Removed, additional_info: "" } }]'
[2025-07-16T15:54:22Z DEBUG dotops::dots_server] Received UpdateWorkloadState: '[WorkloadState { instance_name: WorkloadInstanceName { agent_name: "agent_A", workload_name: "nginx", id: "85b04464a8c3b5348f5976cba412a535beb13155eceb62005531030932cde947" }, execution_state: ExecutionState { state: Pending(Starting), additional_info: "Triggered at runtime." } }]'
[2025-07-16T15:54:22Z DEBUG dotops::dots_server] Received UpdateWorkloadState: '[WorkloadState { instance_name: WorkloadInstanceName { agent_name: "agent_A", workload_name: "greeting_person", id: "2407ceea94e0bc8a0ada66c982bf667c494ed1e0b3b0e70e349475832870476f" }, execution_state: ExecutionState { state: Succeeded(Ok), additional_info: "" } }]'
[2025-07-16T15:54:22Z DEBUG dotops::dots_server] Received UpdateWorkloadState: '[WorkloadState { instance_name: WorkloadInstanceName { agent_name: "agent_A", workload_name: "nginx", id: "85b04464a8c3b5348f5976cba412a535beb13155eceb62005531030932cde947" }, execution_state: ExecutionState { state: Running(Ok), additional_info: "" } }]'
[2025-07-16T15:54:22Z DEBUG grpc::grpc_cli_connection] Connection to CLI (name=cli-conn-6b817b0b-16b0-48c0-935c-b52466f0675e) has been closed.
[2025-07-16T15:54:22Z DEBUG grpc::grpc_cli_connection] Connection to CLI (name=cli-conn-4e06f1f4-3f31-48c6-8d4e-63ee12e2ca39) open.
[2025-07-16T15:54:22Z DEBUG grpc::to_server_proxy] Received Request from 'cli-conn-4e06f1f4-3f31-48c6-8d4e-63ee12e2ca39'
[2025-07-16T15:54:22Z DEBUG dotops::dots_server] Received CompleteStateRequest with id 'cli-conn-4e06f1f4-3f31-48c6-8d4e-63ee12e2ca39@098ab30b-56d2-4412-89a5-5a64e754827b' and field mask: '[]'
[2025-07-16T15:54:22Z DEBUG grpc::grpc_cli_connection] Connection to CLI (name=cli-conn-4e06f1f4-3f31-48c6-8d4e-63ee12e2ca39) failed with Err(ConnectionInterrupted("status: Unknown, message: \"h2 protocol error: error reading a body from connection: stream closed because of a broken pipe\", details: [], metadata: MetadataMap { headers: {} }")).
[2025-07-16T15:54:22Z DEBUG grpc::grpc_cli_connection] Connection to CLI (name=cli-conn-4e06f1f4-3f31-48c6-8d4e-63ee12e2ca39) has been closed.
